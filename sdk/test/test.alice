### test utility ###

export var "":test.current-test
export var "":test.test-file
export var 1:test.all-passed

# includes the file
export fun {
    "running tests for "P p "\n"P
    export :test.test-file
}:test-file

export fun {
    export 1 :test.all-passed
    export :test.current-test
}:test-start

export fun {
    if (test.all-passed) {
        "    test success: "P test.current-test P "\n"P
    } fi
    export "":test.current-test
}:test-end

export fun {
    if (not) {
        0 :test.all-passed
        "    test failure: "P test.current-test P "\n"P
        "test failure" throw
    } fi
}:assert

export fun {
    eq assert
}:asserteq
